structure = {
    "第1章 差分方程": [
        "1.1 一阶差分方程",
        "1.2 p阶差分方程",
        "附录1.A 第1章性质证明",
    ],
    "第2章 滞后算子": [
        "2.1 简介",
        "2.2 一阶差分方程",
        "2.3 二阶差分方程",
        "2.4 p阶差分方程",
        "2.5 初始条件及无界序列",
    ],
    "第3章 平稳自回归移动平均过程": [
        "3.1 期望、平稳性和遍历性",
        "3.2 白噪声",
        "3.3 移动平均过程",
        "3.4 自回归过程",
        "3.5 混合自回归移动平均过程",
        "3.6 自协方差生成函数",
        "3.7 可逆性",
        "附录3.A 无限阶移动平均过程的收敛结论",
        "第3章习题",
    ],
    "第4章 预测": [
        "4.1 预测的原理",
        "4.2 基于无限个观测的预测",
        "4.3 基于有限个观测的预测",
        "4.4 正定对称矩阵的三角分解",
        "4.5 线性投影更新",
        "4.6 高斯过程的最优预测",
        "4.7 自回归移动平均过程的和",
        "4.8 沃尔德分解与博克斯詹金斯建模哲学",
        "附录 4.A 普通最小二乘回归与线性投影",
        "附录 4.B 一阶移动平均过程协方差矩阵的三角分解",
        "第4章习题",
    ],
    "第5章 极大似然估计": [
        "5.1 简介",
        "5.2 高斯一阶自回归过程的似然函数",
        "5.3 高斯 p阶自回归过程的似然函数",
        "5.4 高斯一阶移动平均过程的似然函数",
        "5.5 高斯 q阶移动平均过程的似然函数",
        "5.6 高斯 p阶自回归q阶移动平均过程的似然函数",
        "5.7 数值优化",
        "5.8 极大似然估计的统计推断",
        "5.9 不等式约束",
        "附录5.A 第5章性质证明",
        "第5章习题",
    ],
    "第6章 谱分析": [
        "6.1 总体谱",
        "6.2 样本谱",
        "6.3 总体谱估计",
        "6.4 谱分析的应用",
        "附录6.A 第6章性质证明",
        "第6章习题",
    ],
    "第7章 渐近分布理论": [
        "7.1 渐近分布理论回顾",
        "7.2 序列相关观测的极限定理",
        "附录7.A 第7章性质证明",
        "第7章习题",
    ],
    "第8章 线性回归模型": [
        "8.1 确定性回归元与独立同分布高斯扰动下的普通最小二乘法回顾",
        "8.2 一般条件下的普通最小二乘法",
        "8.3 广义最小二乘法",
        "附录8.A 第8章性质证明",
        "第8章习题",
    ],
    "第9章 线性联立方程系统": [
        "9.1 联立方程偏差",
        "9.2 工具变量与两阶段最小二乘法",
        "9.3 识别",
        "9.4 完全信息极大似然估计",
        "9.5 基于简化型的估计",
        "9.6 联立方程偏差综述",
        "附录9.A 第9章性质证明",
        "第9章习题",
    ],
    "第10章 协方差平稳的向量过程": [
        "10.1 向量自回归简介",
        "10.2 向量过程的自协方差与收敛性结论",
        "10.3 向量过程的自协方差生成函数",
        "10.4 向量过程的谱",
        "10.5 向量过程的样本均值",
        "附录10.A 第10章性质证明",
        "第10章习题",
    ],
    "第11章 向量自回归": [
        "11.1 无约束向量自回归的极大似然估计与假设检验",
        "11.2 二元格兰杰因果检验",
        "11.3 有约束向量自回归的极大似然估计",
        "11.4 脉冲响应函数",
        "11.5 方差分解",
        "11.6 向量自回归与结构计量模型",
        "11.7 脉冲响应函数的标准误",
        "附录11.A 第11章性质证明",
        "附录11.B 解析导数的计算",
        "第11章习题",
    ],
    "第12章 贝叶斯分析": [
        "12.1 贝叶斯分析简介",
        "12.2 向量自回归的贝叶斯分析",
        "12.3 数值贝叶斯方法",
        "附录12.A 第12章性质证明",
        "第12章习题",
    ],
    "第13章 卡尔曼滤波": [
        "13.1 动态系统的状态空间表达",
        "13.2 卡尔曼滤波的推导",
        "13.3 基于状态空间表达的预测",
        "13.4 参数的极大似然估计",
        "13.5 稳态卡尔曼滤波",
        "13.6 平滑",
        "13.7 卡尔曼滤波的统计推断",
        "13.8 时变参数",
        "附录13.A 第13章性质证明",
        "第13章习题",
    ],
    "第14章 广义矩方法": [
        "14.1 广义矩估计",
        "14.2 例子",
        "14.3 拓展",
        "14.4 广义矩与极大似然估计",
        "附录14.A 第14章性质证明",
        "第14章习题",
    ],
    "第15章 非平稳时间序列模型": [
        "15.1 简介",
        "15.2 为什么考虑线性时间趋势和单位根?",
        "15.3 趋势平稳和单位根过程的比较",
        "15.4 单位根检验的含义",
        "15.5 趋势时间序列的其他方法",
        "附录15.A 第15章部分公式的推导",
    ],
    "第16章 确定性时间趋势过程": [
        "16.1 简单时间趋势模型普通最小二乘估计的渐近分布",
        "16.2 简单时间趋势模型的假设检验",
        "16.3 含确定性时间趋势的自回归过程的渐近推断",
        "附录16.A 第16章部分公式的推导",
        "第16章习题",
    ],
    "第17章 带有单位根的单变量过程": [
        "17.1 简介",
        "17.2 布朗运动",
        "17.3 泛函中心极限定理",
        "17.4 真实系数为1时一阶自回归的渐近性质",
        "17.5 存在一般序列相关的单位根过程的渐近结论",
        "17.6 单位根的菲利普斯佩龙检验",
        "17.7 p阶自回归的渐近性质和增广的迪基富勒单位根检验",
        "17.8 单位根检验的其他方法",
        "17.9 贝叶斯分析"
    ],
    "第18章 多变量时间序列的单位根": [
        "18.1 非平稳向量过程的渐近结果",
        "18.2 包含单位根的向量自回归过程",
        "18.3 伪回归",
        "附录18.A 第18章性质证明",
        "第18章习题",
    ],
    "第19章 协整": [
        "19.1 简介",
        "19.2 零假设为没有协整关系的检验",
        "19.3 协整向量的假设检验",
        "附录19.A 第19章性质证明",
        "第19章习题",
    ],
    "第20章 协整系统的完全信息极大似然分析": [
        "20.1 典则相关",
        "20.2 极大似然估计",
        "20.3 假设检验",
        "20.4 单位根检验综述———差分还是不差分?",
        "附录20.A 第20章性质证明",
        "第20章习题",
    ],
    "第21章 带有异方差的时间序列模型": [
        "21.1 自回归条件异方差（ARCH）",
        "21.2 扩展",
        "附录21.A 第21章部分公式的推导",
    ],
    "第22章 机制变化的时间序列建模": [
        "22.1 简介",
        "22.2 马尔可夫链",
        "22.3 独立同分布的混合分布的统计分析",
        "22.4 机制变化的时间序列模型"
    ]
}




import os
import json
from typing import Union, Dict, List, Any

def create_directories_and_files(
    base_path: str, 
    structure: Dict[str, Any], 
    readme_file, 
    parent_path: str = "", 
    level: int = 1
):
    """
    根据给定的目录结构创建目录和文件，并生成 README.md 文件。

    Args:
        base_path (str): 根目录路径。
        structure (Dict[str, Any]): 目录结构的嵌套字典。
        readme_file (File): 用于写入README内容的文件对象。
        parent_path (str): 父目录路径。
        level (int): 目录的层级，用于确定 README 标题级别。

    Returns:
        None
    """
    heading = "#" * level

    for key, value in structure.items():
        current_path = os.path.join(base_path, key.replace(" ", "_").replace("-", "_"))

        # 创建目录
        os.makedirs(current_path, exist_ok=True)

        # 在README中添加章节标题
        if parent_path:
            readme_file.write(f"{heading} {parent_path}/{key}\n\n")
        else:
            readme_file.write(f"{heading} {key}\n\n")

        # 递归调用创建子目录和文件
        if isinstance(value, dict) and value:
            create_directories_and_files(
                current_path, 
                value, 
                readme_file, 
                parent_path + "/" + key if parent_path else key, 
                level + 1
            )
        elif isinstance(value, list):
            for idx, item in enumerate(value):
                item = f"{idx:02d}_{item}"
                file_name = item.replace(" ", "_").replace("-", "_") + ".py"
                file_path = os.path.join(current_path, file_name)
                with open(file_path, 'w', encoding='utf-8') as file:
                    file.write(f"# {item}\n\n")
                    file.write(f'"""\nLecture: {parent_path}/{key}\nContent: {item}\n"""\n\n')

                # 在README中添加文件链接
                item_clean = item.replace(" ", "_").replace("-", "_")
                parent_clean = parent_path.replace(" ", "_").replace("-", "_")
                key_clean = key.replace(" ", "_").replace("-", "_")
                readme_file.write(f"- [{item}](./{parent_clean}/{key_clean}/{item_clean}.py)\n")
        else:
            # 创建文件并写入初始内容
            file_name = key.replace(" ", "_").replace("-", "_") + ".py"
            file_path = os.path.join(current_path, file_name)
            with open(file_path, 'w', encoding='utf-8') as file:
                file.write(f"# {key}\n\n")
                file.write(f'"""\nLecture: {parent_path}/{key}\nContent: {key}\n"""\n\n')

            # 在README中添加文件链接
            parent_clean = parent_path.replace(" ", "_").replace("-", "_")
            key_clean = key.replace(" ", "_").replace("-", "_")
            readme_file.write(f"- [{key}](./{parent_clean}/{key_clean}/{file_name})\n")

        # 添加空行以分隔不同的章节
        readme_file.write("\n")

def main():
    root_dir = './'
    # 创建根目录
    os.makedirs(root_dir, exist_ok=True)

    # 创建 README.md 文件
    with open(os.path.join(root_dir, "README.md"), 'w', encoding='utf-8') as readme_file:
        readme_file.write("# 时间序列\n\n")
        readme_file.write("这是一个关于时间序列的目录结构。\n\n")
        create_directories_and_files(root_dir, structure, readme_file)

    print("目录和文件结构已生成，并创建 README.md 文件。")

if __name__ == "__main__":
    main()