# 01_1.2 p阶差分方程

"""
Lecture: /第1章 差分方程
Content: 01_1.2 p阶差分方程
"""


### 1.2 p阶差分方程

#### 1. p阶差分方程的定义

一个 $ p $ 阶差分方程包含一个变量及其前 $ p $ 个时间点值的方程，用于描述变量随时间的离散变化。

##### 一般形式

一个 $ p $ 阶差分方程的标准形式为：
$$ x_{t+p} + a_{p-1} x_{t+p-1} + \cdots + a_1 x_{t+1} + a_0 x_t = f(t) $$

其中：
- $ x_t $ 是时间 $ t $ 时刻的变量值。
- $ a_0, a_1, \ldots, a_{p-1} $ 是常数系数。
- $ f(t) $ 是关于时间 $ t $ 的已知函数。

#### 2. 齐次与非齐次差分方程

p阶差分方程可以分为齐次（Homogeneous）和非齐次（Non-homogeneous）两类。

##### 齐次 p 阶差分方程

齐次 $ p $ 阶差分方程的形式为：
$$ x_{t+p} + a_{p-1} x_{t+p-1} + \cdots + a_1 x_{t+1} + a_0 x_t = 0 $$

##### 非齐次 p 阶差分方程

非齐次 $ p $ 阶差分方程的形式为：
$$ x_{t+p} + a_{p-1} x_{t+p-1} + \cdots + a_1 x_{t+1} + a_0 x_t = f(t) $$

#### 3. p 阶差分方程的解法

##### 齐次 p 阶差分方程的解法

对于齐次 $ p $ 阶差分方程，我们可以通过求解其特征方程得到其通解。

###### 特征方程

特征方程定义为：
$$ \lambda^p + a_{p-1} \lambda^{p-1} + \cdots + a_1 \lambda + a_0 = 0 $$

通过求解特征方程，我们可以得到其特征根 $ \lambda_i $（可能是实数或复数）。

###### 解的形式

根据特征根的不同情况，齐次方程的通解可以分为以下几种情况：

1. **所有特征根不同**：
   $$ x_t = C_1 \lambda_1^t + C_2 \lambda_2^t + \cdots + C_p \lambda_p^t $$

2. **有重复特征根**：
   如果特征根 $ \lambda $ 重复 $ k $ 次，则通解中对应的项为：
   $$ (C_1 + C_2 t + C_3 t^2 + \cdots + C_k t^{k-1}) \lambda^t $$

##### 非齐次 p 阶差分方程的解法

对于非齐次 $ p $ 阶差分方程，我们可以使用“特解+通解”的方法求解。

###### 特解

首先找到非齐次方程的特解 $ x_t^p $，然后将其代入方程验证。

###### 通解

齐次方程的通解 $ x_t^h $ 和非齐次方程的特解 $ x_t^p $ 的和即为非齐次方程的通解：
$$ x_t = x_t^h + x_t^p $$

#### 4. 数学推导示例

我们以一个具体的非齐次二阶差分方程为例，详细推导其解法。

##### 示例

考虑方程：
$$ x_{t+2} - 3 x_{t+1} + 2 x_t = 4^t $$

1. 求解对应的齐次方程 $ x_{t+2} - 3 x_{t+1} + 2 x_t = 0 $ 的通解：
   - 特征方程为：
     $$ \lambda^2 - 3 \lambda + 2 = 0 $$
     解得特征根：
     $$ \lambda = 1, \, 2 $$
   - 齐次方程的通解为：
     $$ x_t^h = C_1 1^t + C_2 2^t = C_1 + C_2 2^t $$

2. 找到非齐次方程的特解。假设特解为 $ x_t^p = A 4^t $，代入原方程：
   $$ A 4^{t+2} - 3 A 4^{t+1} + 2 A 4^t = 4^t $$
   $$ 16A 4^t - 12A 4^t + 2A 4^t = 4^t $$
   $$ 6A 4^t = 4^t $$
   $$ A = \frac{1}{6} $$
   所以特解为：
   $$ x_t^p = \frac{1}{6} 4^t $$

3. 通解为：
   $$ x_t = x_t^h + x_t^p = C_1 + C_2 2^t + \frac{1}{6} 4^t $$

#### 5. 数学推导详细

以下是一个详细推导过程的示例。

##### 示例

考虑一个更一般的非齐次二阶差分方程：
$$ x_{t+2} + a_1 x_{t+1} + a_0 x_t = f(t) $$

1. 齐次部分的解为：
   - 特征方程为：
     $$ \lambda^2 + a_1 \lambda + a_0 = 0 $$
     解得特征根 $ \lambda_1, \lambda_2 $。
   - 齐次方程的通解为：
     $$ x_t^h = C_1 \lambda_1^t + C_2 \lambda_2^t $$

2. 找到非齐次方程的特解 $ x_t^p $。

3. 通解为：
   $$ x_t = x_t^h + x_t^p = C_1 \lambda_1^t + C_2 \lambda_2^t + x_t^p $$

设初始条件为 $ x_0 = x_0 $ 和 $ x_1 = x_1 $，则我们可以通过代入初始条件求解 $ C_1 $ 和 $ C_2 $。

#### 6. p 阶差分方程的应用

p 阶差分方程在多个领域有广泛应用，如经济学、工程学、物理学等。

##### 经济学应用

在经济学中，p 阶差分方程可以用来描述复杂的经济指标随时间的变化。例如，假设某经济指标 $ Y_t $ 随时间的变化满足二阶差分方程：
$$ Y_{t+2} - 1.5 Y_{t+1} + 0.5 Y_t = 0 $$

通过解这个方程，我们可以预测未来的经济指标。

##### 工程学应用

在工程学中，p 阶差分方程用于描述信号处理和控制系统。例如，某信号 $ S_t $ 满足三阶差分方程：
$$ S_{t+3} - 2 S_{t+2} + S_{t+1} - 0.5 S_t = 0 $$

通过解这个方程，我们可以分析和处理信号。
