# 00_1.1 一阶差分方程

"""
Lecture: /第1章 差分方程
Content: 00_1.1 一阶差分方程
"""


### 1.1 一阶差分方程

#### 1. 一阶差分方程的定义

一阶差分方程是指包含一个变量及其前一个时间点值的方程，用于描述变量随时间的离散变化。

##### 一般形式

一阶差分方程的标准形式为：
$$ x_{t+1} - x_t = f(t, x_t) $$

或者等价地表示为：
$$ x_{t+1} = x_t + f(t, x_t) $$

其中：
- $ x_t $ 是时间 $ t $ 时刻的变量值。
- $ f(t, x_t) $ 是关于时间 $ t $ 和变量 $ x_t $ 的函数。

#### 2. 齐次与非齐次差分方程

一阶差分方程可以分为齐次（Homogeneous）和非齐次（Non-homogeneous）两类。

##### 齐次一阶差分方程

齐次一阶差分方程的形式为：
$$ x_{t+1} = a x_t $$

其中 $ a $ 是常数。

##### 非齐次一阶差分方程

非齐次一阶差分方程的形式为：
$$ x_{t+1} = a x_t + b(t) $$

其中 $ a $ 是常数，$ b(t) $ 是关于时间 $ t $ 的已知函数。

#### 3. 一阶差分方程的解法

##### 齐次一阶差分方程的解法

对于齐次一阶差分方程：
$$ x_{t+1} = a x_t $$

我们可以通过迭代的方法求解。设初始条件为 $ x_0 $，则：
$$ x_1 = a x_0 $$
$$ x_2 = a x_1 = a^2 x_0 $$
$$ x_3 = a x_2 = a^3 x_0 $$
以此类推，我们得到一般解为：
$$ x_t = a^t x_0 $$

##### 非齐次一阶差分方程的解法

对于非齐次一阶差分方程：
$$ x_{t+1} = a x_t + b(t) $$

我们可以使用“特解+通解”的方法求解。首先，求解对应的齐次方程的通解：
$$ x_t^h = A a^t $$

然后，找到特解 $ x_t^p $，使得：
$$ x_t^p = x_t^p + b(t) $$

最后，通解为齐次方程的通解和非齐次方程的特解之和：
$$ x_t = x_t^h + x_t^p $$

#### 4. 数学推导示例

我们以一个具体的非齐次一阶差分方程为例，详细推导其解法。

##### 示例

考虑方程：
$$ x_{t+1} = 2 x_t + 3 $$

1. 求解对应的齐次方程 $ x_{t+1} = 2 x_t $ 的通解：
$$ x_t^h = A 2^t $$

2. 找到特解 $ x_t^p $。假设特解为常数形式 $ x_t^p = C $，代入原方程：
$$ C = 2C + 3 $$
$$ C = -3 $$

3. 通解为：
$$ x_t = x_t^h + x_t^p = A 2^t - 3 $$

设初始条件为 $ x_0 = x $，则：
$$ x = A 2^0 - 3 $$
$$ A = x + 3 $$

因此，方程的最终解为：
$$ x_t = (x + 3) 2^t - 3 $$

#### 5. 一阶差分方程的应用

一阶差分方程在多个领域有广泛应用，如经济学、人口模型、物理学等。

##### 经济学应用

在经济学中，一阶差分方程可以用来描述股票价格、GDP增长等随时间的变化。例如，假设某股票价格 $ P_t $ 随时间的变化满足方程：
$$ P_{t+1} = 1.05 P_t + 2 $$

通过解这个方程，我们可以预测未来的股票价格。

##### 人口模型

在人口模型中，假设人口数量 $ N_t $ 满足方程：
$$ N_{t+1} = 1.02 N_t + 100 $$

通过解这个方程，我们可以预测未来的总人口数量。

#### 6. 数学推导详细

以下是一个详细推导过程的示例。

##### 示例

考虑一个更一般的非齐次一阶差分方程：
$$ x_{t+1} = a x_t + b $$

1. 齐次部分的解为：
$$ x_t^h = A a^t $$

2. 假设特解为常数 $ x_t^p = C $，代入方程：
$$ C = aC + b $$
$$ C(1 - a) = b $$
$$ C = \frac{b}{1 - a} $$

3. 通解为：
$$ x_t = x_t^h + x_t^p = A a^t + \frac{b}{1 - a} $$

设初始条件为 $ x_0 = x $，则：
$$ x = A a^0 + \frac{b}{1 - a} $$
$$ A = x - \frac{b}{1 - a} $$

因此，方程的最终解为：
$$ x_t = \left(x - \frac{b}{1 - a}\right) a^t + \frac{b}{1 - a} $$
